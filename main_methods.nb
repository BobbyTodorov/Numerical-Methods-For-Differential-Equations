(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     51174,       1435]
NotebookOptionsPosition[     49594,       1408]
NotebookOutlinePosition[     49968,       1424]
CellTagsIndexPosition[     49925,       1421]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Qven", " ", "metod", " ", "na", " ", "Oiler"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"explicitEuler", "[", 
    RowBox[{
    "f_", ",", " ", "h_", ",", " ", "t0_", ",", " ", "T_", ",", " ", "u0_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"(", "\n", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Ceiling", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"T", " ", "-", " ", "t0"}], ")"}], "/", "h"}], "]"}]}], ";", 
     "\n", 
     RowBox[{"x", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"t0", " ", "+", " ", 
         RowBox[{"i", "*", "h"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "0", ",", " ", "n"}], "}"}]}], "]"}]}], ";", 
     "\n", 
     RowBox[{"y", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"{", 
         RowBox[{"n", " ", "+", " ", "1"}], "}"}]}], "]"}]}], ";", "\n", "\n", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "u0"}], ";", "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<", " ", 
        RowBox[{"n", " ", "+", " ", "1"}]}], " ", ",", " ", 
       RowBox[{"i", "++"}], ",", "\n", "   ", 
       RowBox[{
        RowBox[{"y", "[", 
         RowBox[{"[", 
          RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "+", " ", 
         RowBox[{"h", "*", 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
            RowBox[{"y", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}]}]}], "\n", "]"}], 
     ";", "\n", "\n", "  ", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", " ", "y"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8220221294244003`*^9, 3.8220221666879663`*^9}, {
  3.822022206364917*^9, 3.822022214780662*^9}, {3.8220245816603403`*^9, 
  3.822024613917615*^9}, {3.8220246440677595`*^9, 3.822024646964697*^9}, {
  3.8220247722473516`*^9, 3.8220247961807404`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"df0d95ab-143c-4842-abbe-8115eff4a546"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Neqven", " ", "metod", " ", "na", " ", "Oiler"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"implicitEuler", "[", 
    RowBox[{
    "f_", ",", " ", "h_", ",", " ", "t0_", ",", " ", "T_", ",", " ", "u0_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Ceiling", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"T", "-", "t0"}], ")"}], "/", "h"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"t0", " ", "+", " ", 
         RowBox[{"i", "*", "h"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "0", ",", " ", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", " ", 
        RowBox[{"{", 
         RowBox[{"n", " ", "+", " ", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "u0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
       RowBox[{"i", " ", "<", " ", 
        RowBox[{"n", " ", "+", " ", "1"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"initial", " ", "=", " ", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "+", " ", 
          RowBox[{"h", "*", 
           RowBox[{"f", "[", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"y", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"yNew", " ", "/.", " ", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"yNew", " ", "\[Equal]", " ", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"[", "i", "]"}], "]"}], " ", "+", " ", 
              RowBox[{"h", "*", 
               RowBox[{"f", "[", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "yNew"}], 
                "]"}]}]}]}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"yNew", ",", " ", "initial"}], "}"}]}], "]"}]}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8220249932688017`*^9, 3.8220251046467953`*^9}, {
  3.8220252542683687`*^9, 3.8220253091988573`*^9}, {3.8220253525026274`*^9, 
  3.8220254441741676`*^9}, {3.822025580196875*^9, 3.822025585329914*^9}, {
  3.822025621934318*^9, 3.822025624333638*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"7289abab-60fb-4e2d-9b20-f1eb688ae156"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Newton", "[", 
   RowBox[{"g_", ",", "x0_", ",", " ", "tol_", ",", " ", "maxIter_"}], "]"}], 
  ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xCurrent", " ", "=", " ", "x0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"xNext", " ", "=", " ", 
     RowBox[{"xCurrent", " ", "-", " ", 
      RowBox[{
       RowBox[{"g", "[", "xCurrent", "]"}], "/", 
       RowBox[{
        RowBox[{"g", "'"}], "[", "xCurrent", "]"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"iter", "=", "1"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"xCurrent", "-", "xNext"}], "]"}], "\[GreaterEqual]", 
        "tol"}], " ", "&&", " ", 
       RowBox[{"iter", "<", "maxIter"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xCurrent", " ", "=", " ", "xNext"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xNext", " ", "=", " ", 
        RowBox[{"xCurrent", " ", "-", " ", 
         RowBox[{
          RowBox[{"g", "[", "xCurrent", "]"}], "/", 
          RowBox[{
           RowBox[{"g", "'"}], "[", "xCurrent", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"iter", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "xNext"}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{3.822026494611001*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"cb17505e-7a0e-4372-b534-66d0cf13425d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Runge", "-", "Kuta"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RK4", "[", 
    RowBox[{"f_", ",", "h_", ",", "t0_", ",", "T_", ",", "u0_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"T", "-", "t0"}], ")"}], "/", "h"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"t0", "+", 
         RowBox[{"i", "*", "h"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "u0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "n"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"k1", "=", 
         RowBox[{"h", "*", 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"y", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"k2", "=", 
         RowBox[{"h", "*", 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"h", "/", "2"}]}], ",", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"k1", "/", "2"}]}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"k3", "=", 
         RowBox[{"h", "*", 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"h", "/", "2"}]}], ",", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"k2", "/", "2"}]}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"k4", "=", 
         RowBox[{"h", "*", 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", "h"}], ",", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", "k3"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"1", "/", "6"}], " ", "k1"}], "+", 
          RowBox[{
           RowBox[{"1", "/", "3"}], " ", "k2"}], "+", 
          RowBox[{
           RowBox[{"1", "/", "3"}], " ", "k3"}], "+", 
          RowBox[{
           RowBox[{"1", "/", "6"}], " ", "k4"}]}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8220267314547825`*^9, 3.8220267314567804`*^9}, {
  3.8220337117572184`*^9, 
  3.822033720412881*^9}},ExpressionUUID->"4b8db239-e106-42c8-ac43-\
b2010515e8d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Adams", "-", "Bashford"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AB4", "[", 
    RowBox[{"f_", ",", "h_", ",", "t0_", ",", "T_", ",", "u0_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"T", "-", "t0"}], ")"}], "/", "h"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"t0", "+", 
         RowBox[{"i", " ", "h"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", "+", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fi", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", "+", "1"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "list", " ", "of", " ", "values", " ", "of", " ", "the", " ", 
        "right"}], "-", 
       RowBox[{"hand", " ", "side", " ", "f"}]}], "*)"}], 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "u0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fi", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"f", "[", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"y", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Compute", " ", "the", " ", "first", " ", "approximate", " ", 
        "values"}], ",", 
       RowBox[{"using", " ", "the", " ", "RK4", " ", "method"}]}], "*)"}], 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "3"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"k1", "=", 
         RowBox[{"h", " ", 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"y", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"k2", "=", 
         RowBox[{"h", " ", 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"h", "/", "2"}]}], ",", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"k1", "/", "2"}]}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"k3", "=", 
         RowBox[{"h", " ", 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"h", "/", "2"}]}], ",", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"k2", "/", "2"}]}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"k4", "=", 
         RowBox[{"h", " ", 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", "h"}], ",", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", "k3"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"1", "/", "6"}], " ", 
           RowBox[{"(", 
            RowBox[{"k1", "+", 
             RowBox[{"2", " ", "k2"}], "+", 
             RowBox[{"2", " ", "k3"}], "+", "k4"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fi", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
           RowBox[{"y", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], ";"}]}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Compute", " ", "the", " ", "remaining", " ", "values"}], ",", 
       RowBox[{"using", " ", "the", " ", "AB4", " ", "formula"}]}], "*)"}], 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "4"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{"n", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"h", "/", "24"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"55", " ", 
              RowBox[{"fi", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "-", 
             RowBox[{"59", " ", 
              RowBox[{"fi", "[", 
               RowBox[{"[", 
                RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "+", 
             RowBox[{"37", " ", 
              RowBox[{"fi", "[", 
               RowBox[{"[", 
                RowBox[{"i", "-", "2"}], "]"}], "]"}]}], "-", 
             RowBox[{"9", " ", 
              RowBox[{"fi", "[", 
               RowBox[{"[", 
                RowBox[{"i", "-", "3"}], "]"}], "]"}]}]}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fi", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
           RowBox[{"y", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], ";"}]}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8220267391827917`*^9, 3.8220267391827917`*^9}, {
  3.8220337248344383`*^9, 
  3.822033729818488*^9}},ExpressionUUID->"08c505dd-f97e-4f48-83fd-\
a93511609eef"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.8220270483024797`*^9, 3.8220270838071437`*^9}, 
   3.822033694086542*^9},ExpressionUUID->"73b0f805-e5c2-4163-ad46-\
1688ffbd613b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Qvna", " ", "shema", " ", "za", " ", "uravnenie", " ", "na", " ", 
    "difuziqta", " ", "s", " ", "granichni", " ", "usloviq", " ", "na", " ", 
    "Dirihle"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"heatEquation", "[", 
    RowBox[{
    "l_", ",", "T_", ",", "h_", ",", "u0_", ",", "uL_", ",", "uR_", ",", 
     "d_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Tau]", "=", 
      RowBox[{
       RowBox[{"h", "^", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{"3", "d"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"l", "/", "h"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"T", "/", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}], "*", "h"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "-", "1"}], ")"}], "*", "\[Tau]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"m", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", "+", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", "+", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Initial", " ", "condition"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"n", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"u0", "[", 
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Iterate", " ", "over", " ", "time"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "m"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Internal", " ", "values", " ", "from", " ", "the", " ", "main", " ", 
         "PDE"}], "*)"}], 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "\[LessEqual]", "n"}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
            RowBox[{"d", " ", 
             RowBox[{"\[Tau]", "/", 
              RowBox[{"h", "^", "2"}]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"y", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "+", 
               RowBox[{"y", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", "j"}], "]"}], "]"}]}], 
              ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Boundary", " ", "conditions"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", 
            RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{"uL", "[", 
          RowBox[{"t", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"n", "+", "1"}], ",", 
            RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{"uR", "[", 
          RowBox[{"t", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "]"}]}], ";"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x", ",", "t", ",", "y"}], "}"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8220268334351845`*^9, 3.8220268334351845`*^9}, {
   3.8220269079201407`*^9, 3.822026914522154*^9}, 3.822026982890154*^9, {
   3.822033695836412*^9, 
   3.8220336965082555`*^9}},ExpressionUUID->"911462fd-8a9e-4eb4-af94-\
f278cd389149"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.822022249822468*^9, 3.8220224870364265`*^9}, {
  3.8220225373503556`*^9, 3.822022604952734*^9}, {3.822022694360627*^9, 
  3.8220226959073973`*^9}, {3.822023551689231*^9, 3.822023552461789*^9}, {
  3.8220236679339385`*^9, 3.82202366904322*^9}, {3.8220243351200256`*^9, 
  3.822024371999728*^9}, {3.822024485843473*^9, 3.822024489533703*^9}, {
  3.822024577445088*^9, 
  3.822024578195055*^9}},ExpressionUUID->"ebb46a86-12a4-4e62-aa80-\
790f24ffbd64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Qvna", " ", "shema", " ", "za", " ", "uravnenie", " ", "na", " ", 
    "difuziqta", " ", "s", " ", "granichni", " ", "usloviq", " ", "na", " ", 
    "Noiman"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"heatEquation", "[", 
    RowBox[{
    "l_", ",", "T_", ",", "h_", ",", "u0_", ",", "d_", ",", "k_", ",", "v_"}],
     "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Tau]", "=", 
      RowBox[{
       RowBox[{"h", "^", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "d"}], "+", 
         RowBox[{"k", "*", 
          RowBox[{"h", "^", "2"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"l", "/", "h"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"T", "/", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"i", "*", "h"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"i", "*", "\[Tau]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "m"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", "+", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", "+", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Initial", " ", "condition"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"n", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"u0", "[", 
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Iterate", " ", "over", " ", "time"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "m"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Internal", " ", "values", " ", "from", " ", "the", " ", "main", " ", 
         "PDE"}], "*)"}], 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "\[LessEqual]", "n"}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"d", " ", 
             RowBox[{"\[Tau]", "/", 
              RowBox[{"h", "^", "2"}]}], " ", 
             RowBox[{"y", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"2", " ", "d", " ", 
                RowBox[{"\[Tau]", "/", 
                 RowBox[{"h", "^", "2"}]}]}], "-", 
               RowBox[{"\[Tau]", "*", "k"}]}], ")"}], "*", 
             RowBox[{"y", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "+", 
            RowBox[{"d", " ", 
             RowBox[{"\[Tau]", "/", 
              RowBox[{"h", "^", "2"}]}], " ", 
             RowBox[{"y", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "j"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"v", "[", 
              RowBox[{"x", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], " ", "\[Tau]", " ", 
             "k"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Boundary", " ", "conditions"}], "*)"}], 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", 
            RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", "*", "d", "*", 
              RowBox[{"\[Tau]", "/", 
               RowBox[{"h", "^", "2"}]}]}], "-", 
             RowBox[{"\[Tau]", "*", "k"}]}], ")"}], " ", 
           RowBox[{"y", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "j"}], "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", " ", "d", "*", "\[Tau]"}], ")"}], "/", 
            RowBox[{"h", "^", "2"}]}], " ", 
           RowBox[{"y", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"v", "[", "0", "]"}], " ", "\[Tau]", "*", "k"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"n", "+", "1"}], ",", 
            RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", "0"}], ";"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x", ",", "t", ",", "y"}], "}"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8220270910586762`*^9, 3.822027112794881*^9}, {
  3.8220272514068413`*^9, 
  3.822027265351186*^9}},ExpressionUUID->"17d0d2eb-8712-4ec1-990c-\
d6eaa8a00d54"],

Cell[BoxData[""], "Input",ExpressionUUID->"8e220788-1182-4c03-ab25-c2a50e22966b"],

Cell[BoxData[""], "Input",
 CellLabel->"In[24]:=",ExpressionUUID->"d6357675-5330-4ff5-a86b-a52f18bae958"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Diferenchna", " ", "shema", " ", "na", " ", "Krank"}], "-", 
    "Nikalsan"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"KrankNicolson", "[", 
    RowBox[{"l_", ",", "T_", ",", "h_", ",", "u0_", ",", "uL_", ",", "uR_"}], 
    "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Tau]", "=", 
      RowBox[{
       RowBox[{"h", "^", "2"}], "/", "2"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "the", " ", "method", " ", "is", " ", "stable", " ", "in", " ", 
        "max"}], "-", 
       RowBox[{"norm", " ", "for", " ", 
        RowBox[{
         RowBox[{"h", "^", "2"}], "/", "2"}]}]}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Tau]", "=", "h"}], ";"}], "\[Rule]", 
       RowBox[{
        RowBox[{
        "the", " ", "method", " ", "is", " ", "stable", " ", "in", " ", 
         "l2"}], "-", 
        RowBox[{
        "norm", " ", "and", " ", "the", " ", "error", " ", "is", " ", "O", 
         RowBox[{"(", 
          RowBox[{"h", "^", "2"}], ")"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"l", "/", "h"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"T", "/", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"i", "*", "h"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"j", "*", "\[Tau]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "m"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", "+", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", "+", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Initial", " ", "condition"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"n", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"u0", "[", 
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Generate", " ", 
       RowBox[{"matrix", ".", "It"}], " ", "is", " ", "the", " ", "same", " ",
        "for", " ", "all", " ", "times"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", "+", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", "+", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", "1"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ",", 
         RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "=", "1"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "2"}], ",", 
       RowBox[{"i", "\[LessEqual]", "n"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"-", "1"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", 
            RowBox[{"h", "^", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"1", "/", "\[Tau]"}], "+", 
          RowBox[{"1", "/", 
           RowBox[{"h", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"-", "1"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", 
            RowBox[{"h", "^", "2"}]}], ")"}]}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Iterate", " ", "over", " ", "time"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "m"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Generate", " ", "vector", " ", "of", " ", "the", " ", "RHS"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", "+", "1"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"b", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{"uL", "[", 
          RowBox[{"t", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"b", "[", 
          RowBox[{"[", 
           RowBox[{"n", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{"uR", "[", 
          RowBox[{"t", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "\[LessEqual]", "n"}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", "\[Tau]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}], "-", 
                RowBox[{"2", 
                 RowBox[{"y", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "+", 
                RowBox[{"y", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "j"}], "]"}], "]"}]}], ")"}],
               "/", 
              RowBox[{"(", 
               RowBox[{"2", 
                RowBox[{"h", "^", "2"}]}], ")"}]}]}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Solve", " ", "the", " ", "system"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{"A", ",", "b"}], "]"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x", ",", "t", ",", "y"}], "}"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8220271517667503`*^9, 3.822027178889681*^9}, {
  3.82202722553894*^9, 
  3.822027244508275*^9}},ExpressionUUID->"42b814ce-689b-4511-a51a-\
0e73a327f29f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Uravnenie", " ", "na", " ", "prenosa"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Transport", "[", 
    RowBox[{
    "l0_", ",", "l_", ",", "T_", ",", "h_", ",", "u0_", ",", "uL_", ",", 
     "c_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Tau]", "=", 
      RowBox[{"h", "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", "c"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"l", "-", "l0"}], ")"}], "/", "h"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"T", "/", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"l0", "+", 
         RowBox[{"i", "*", "h"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"j", "*", "\[Tau]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "m"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", "+", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", "+", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Initial", " ", "condition"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"n", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"u0", "[", 
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Iterate", " ", "over", " ", "time"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "m"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Boundary", " ", "condition"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", 
            RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{"uL", "[", 
          RowBox[{"t", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Internal", " ", "values", " ", "from", " ", "the", " ", "main", " ",
           "PDE"}], "*)"}], 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"n", "+", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"c", "*", 
                RowBox[{"\[Tau]", "/", "h"}]}]}], ")"}], " ", 
             RowBox[{"y", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "+", 
            RowBox[{"c", " ", 
             RowBox[{"\[Tau]", "/", "h"}], "*", 
             RowBox[{"y", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}]}]}]}], 
         "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x", ",", "t", ",", "y"}], "}"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.822027316311489*^9, 
  3.8220273332249937`*^9}},ExpressionUUID->"4d8bc06c-abaf-46d3-abbe-\
da414788c570"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Uravnenie", " ", "na", " ", "strunata"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"springEquation", "[", 
    RowBox[{
    "l_", ",", "T_", ",", "h_", ",", "uL_", ",", "uR_", ",", "u0_", ",", 
     "c_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Tau]", "=", 
      RowBox[{"h", "/", 
       RowBox[{"(", 
        RowBox[{"2", "*", "c"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"l", "/", "h"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"T", "/", "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"i", "*", "h"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"j", "*", "\[Tau]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "m"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", "+", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", "+", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"First", " ", "initial", " ", "condition"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"n", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
         RowBox[{"u0", "[", 
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Second", " ", "initial", " ", "condition"}], "*)"}], 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "2"}], ",", 
       RowBox[{"i", "\[LessEqual]", "n"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"c", "*", "\[Tau]"}], ")"}], "/", "h"}], ")"}], "^", 
             "2"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}], "-", 
             RowBox[{"2", "*", 
              RowBox[{"y", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "+", 
             RowBox[{"y", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}], 
            ")"}]}]}]}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "left", " ", "and", " ", "right", " ", "boundaty", " ", "conditions", 
       " ", "on", " ", "the", " ", "second", " ", "layer"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"uL", "[", 
       RowBox[{"t", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"n", "+", "1"}], ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"uR", "[", 
       RowBox[{"t", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "2"}], ",", 
       RowBox[{"j", "\[LessEqual]", "m"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "left", " ", "and", " ", "right", " ", "boundary", " ", 
         "conditions"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", 
            RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{"uL", "[", 
          RowBox[{"t", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"y", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"n", "+", "1"}], ",", 
            RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{"uR", "[", 
          RowBox[{"t", "[", 
           RowBox[{"[", 
            RowBox[{"j", "+", "1"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "\[LessEqual]", "n"}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"c", "*", "\[Tau]"}], ")"}], "/", "h"}], ")"}], 
                 "^", "2"}]}], ")"}], "*", 
              RowBox[{"y", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "-", 
             RowBox[{"y", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"c", "*", "\[Tau]"}], ")"}], "/", "h"}], ")"}], 
                "^", "2"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "j"}], "]"}], "]"}], "+", 
                RowBox[{"y", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], 
               ")"}]}]}]}], ";"}]}], "]"}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x", ",", "t", ",", "y"}], "}"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.8220273602798805`*^9, 
  3.822027374555159*^9}},ExpressionUUID->"f3b377c0-83a7-45c9-b1a0-\
3b8650ebe452"]
},
WindowSize->{1322, 697},
WindowMargins->{{Automatic, 54}, {-32, Automatic}},
Magnification:>1.6 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2401, 63, 406, "Input",ExpressionUUID->"df0d95ab-143c-4842-abbe-8115eff4a546"],
Cell[2962, 85, 3303, 85, 436, "Input",ExpressionUUID->"7289abab-60fb-4e2d-9b20-f1eb688ae156"],
Cell[6268, 172, 1564, 39, 406, "Input",ExpressionUUID->"cb17505e-7a0e-4372-b534-66d0cf13425d"],
Cell[7835, 213, 3671, 107, 346, "Input",ExpressionUUID->"4b8db239-e106-42c8-ac43-b2010515e8d2"],
Cell[11509, 322, 6768, 196, 556, "Input",ExpressionUUID->"08c505dd-f97e-4f48-83fd-a93511609eef"],
Cell[18280, 520, 198, 3, 76, "Input",ExpressionUUID->"73b0f805-e5c2-4163-ad46-1688ffbd613b"],
Cell[18481, 525, 5200, 145, 556, "Input",ExpressionUUID->"911462fd-8a9e-4eb4-af94-f278cd389149"],
Cell[23684, 672, 498, 8, 45, "Input",ExpressionUUID->"ebb46a86-12a4-4e62-aa80-790f24ffbd64"],
Cell[24185, 682, 5830, 161, 586, "Input",ExpressionUUID->"17d0d2eb-8712-4ec1-990c-d6eaa8a00d54"],
Cell[30018, 845, 81, 0, 45, "Input",ExpressionUUID->"8e220788-1182-4c03-ab25-c2a50e22966b"],
Cell[30102, 847, 105, 1, 45, "Input",ExpressionUUID->"d6357675-5330-4ff5-a86b-a52f18bae958"],
Cell[30210, 850, 7872, 225, 886, "Input",ExpressionUUID->"42b814ce-689b-4511-a51a-0e73a327f29f"],
Cell[38085, 1077, 4237, 121, 496, "Input",ExpressionUUID->"4d8bc06c-abaf-46d3-abbe-da414788c570"],
Cell[42325, 1200, 7265, 206, 706, "Input",ExpressionUUID->"f3b377c0-83a7-45c9-b1a0-3b8650ebe452"]
}
]
*)

